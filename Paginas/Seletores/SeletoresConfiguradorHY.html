<!DOCTYPE html>

<main id="main-content" class="sr-only">
    <h1>
        Configurador
    </h1>

    <div id="titulo-estrutural">
        Configurador
    </div>
</main>

<link rel="stylesheet" href="/Layout/Galeria/Galeria.min.css">

<main class="main mb-0 pb-0">
    <div class="pagina__titulo--bloco fw-bold mt-5 mb-4">
    </div>
    <div class="container">
        <div class="galeria-produto" data-visible="1.C" data-folder="IBRC" data-title="IBR C"
            data-description="Fabricada com 2 ou 3 estágios de engrenagens cilíndricas helicoidais, essa linha de redutores e motorredutores coaxiais se possui uma grande variedade de opções de reduções, sempre transferindo torque com alto rendimento (proporcionando grande eficiência energética e economia). Os acessórios de fixação como pés e flanges de saída possibilitam diversas opções de montagem nas máquinas e equipamentos."
            data-site="https://www.redutoresibr.com.br/pt/Produtos/ibr-c"
            data-catalog="https://www.redutoresibr.com.br/pt/Arquivos/visualizar/ibr-c-aluminio-e-ferro-fundido#book/">
        </div>

        <div class="galeria-produto" data-visible="1.X" data-folder="IBRX" data-title="IBR X"
            data-description="Devido às combinações de engrenagens cilíndricas helicoidais e cônicas helicoidais retificadas utilizadas em sua montagem, a linha de redutores e motorredutores IBR X se destaca por unir a característica de alto rendimento (eficiência energética) com uma configuração ortogonal, ou seja, saída de 90 graus em relação ao sentido do motor. Os acessórios de fixação como flanges de saída e braço de torque proporcionam diversas opções de montagem nas máquinas e equipamentos, sendo que ainda podem ser fornecidos com eixos de saída maciços ou vazados."
            data-site="https://www.redutoresibr.com.br/pt/Produtos/ibr-x"
            data-catalog="https://www.redutoresibr.com.br/_uploads/dec422d2-355d-4cdb-98db-773333b2228c.pdf">
        </div>

        <div class="galeria-produto" data-visible="1.H" data-folder="IBRH" data-title="IBR H"
            data-description="Os redutores de eixos paralelos IBR H são compostos por 2 ou 3 pares de engrenagens cilíndricas helicoidais retificadas e termicamente tratadas. As combinações e características dessas engrenagens possibilitam variadas opções de reduções e um rendimento elevado, resultando em menor consumo de energia dos motorredutores devido à eficiência. Os redutores e motorredutores IBR H são modulares e possuem alternativas de fixação como pés (na própria carcaça) e flange de saída (mediante solicitação) proporcionando diversas opções de montagem nas máquinas e equipamentos. Eles ainda podem ser fornecidos com eixos de saída vazados ou maciços."
            data-site="https://www.redutoresibr.com.br/pt/Produtos/ibr-h"
            data-catalog="https://www.redutoresibr.com.br/_uploads/6db0594f-7b6f-4fcb-8668-0634acb22a30.pdf">
        </div>

        <div class="galeria-produto" data-visible="1.M" data-folder="IBRM" data-title="IBR M"
            data-description="Possuindo apenas um par de engrenagens cilíndricas helicoidais, a linha de redutores e motorredutores IBR M é direcionada para aplicações que requerem baixas reduções (velocidades de rotação mais elevadas). Suas principais características são o alto rendimento (proporcionando grande eficiência energética e economia), o corpo compacto, leveza, alto desempenho e modularidade. Os acessórios de fixação como pés e flanges de saída proporcionam diversas opções de montagem nas máquinas e equipamentos."
            data-site="https://www.redutoresibr.com.br/pt/Produtos/ibr-m"
            data-catalog="https://www.redutoresibr.com.br/_uploads/3dd138f5-a46b-4d33-828c-129c1c3b9ccf.pdf">
        </div>

        <div class="galeria-produto" data-visible="1.P" data-folder="IBRP" data-title="IBR P"
            data-description="Os redutores de eixos paralelos IBR P são compostos por 2 ou 3 pares de engrenagens cilíndricas helicoidais retificadas e termicamente tratadas. As combinações e características dessas engrenagens possibilitam variadas opções de reduções e um rendimento elevado, resultando em menor consumo de energia dos motorredutores devido à eficiência."
            data-site="https://www.redutoresibr.com.br/pt/Produtos/ibr-p"
            data-catalog="https://www.redutoresibr.com.br/_uploads/746d153e-a6b0-4dc5-8cb1-8c56286dfd65.pdf">
        </div>

        <div class="galeria-produto" data-visible="1.R" data-folder="IBRR" data-title="IBR R"
            data-description="Fabricada com engrenagens do tipo coroa e rosca sem fim, a linha de redutores e motorredutores IBR R se destaca pela alta qualidade, excelente desempenho e modularidade. O formato redondo de seu corpo o torna mais compacto, sendo que ele ainda possui opções de acessórios de fixação, como pés, flanges de saída e braços de torque, proporcionam diversas opções de montagem nas máquinas e equipamentos. Eles podem ainda ser fornecidos com eixos de saída maciços ou vazados. Os redutores IBR R são fabricados em carcaça de alumínio, conferindo leveza e melhorando a dissipação de calor."
            data-site="https://www.redutoresibr.com.br/pt/Produtos/ibr-r"
            data-catalog="https://www.redutoresibr.com.br/_uploads/edafe063-e98b-406a-b14d-26d0fd30e543.pdf">
        </div>
    </div>
    <div id="titulo-configurador" class="pagina__titulo--bloco mt-5 mb-5 text-center">
        <h2 id="texto-configurador" class="fs-3 fw-bolder m-0"></h2>
    </div>
</main>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        function atualizarTitulo() {
            const visivel = Array.from(document.querySelectorAll('.galeria-produto[data-title]'))
                .find(g => g.style.display !== 'none');
            const titulo = visivel ? visivel.dataset.title : '';
            const el = document.getElementById('texto-configurador');
            if (!el) return;
            if (!titulo) {
                el.innerHTML = '';
                document.title = 'Configurador de Produtos';
                return;
            }
            let html = 'Configure o seu ';
            if (titulo.toUpperCase().startsWith('IBR ')) {
                const partes = titulo.split(' ');
                const primeiro = partes.shift();
                const resto = partes.join(' ');
                html += '<span class="text-dark">' + primeiro + '</span>';
                if (resto) html += ' <span class="text-orange">' + resto + '</span>';
            } else {
                html += titulo;
            }
            el.innerHTML = html;
            document.title = 'Configurador de Produtos - ' + titulo;
        }
        atualizarTitulo();
        setTimeout(atualizarTitulo);
        document.getElementById('HYLN')?.addEventListener('change', atualizarTitulo);
    });
</script>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const helpConfigs = {

            GrupoHYLN() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoHYBR() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoHYRD() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoHYCM() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoHYBU() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoHYCP() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoHYAF() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoHYAFP() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoHYBT() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoHYPE() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoHYAS() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoHYASP() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoHYPM() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoHYOPC() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoHYMO() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoMOLN() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoMOTP() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoMOTT() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoMOFQ() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoMOPT() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoMOPL() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoMOCP() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoMOCPP() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoMOPC() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoMOPP() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoMOOPC() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoMOCR() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoHYCR() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoHYVA() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoVALN() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoVAPT() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoVAECP() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoVASCP() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoVAPM() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoHYPL() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoPLDE() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoPLBU() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoPLGU() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },

            GrupoPLFU() {
                return {
                    title: 'Em Desenvolvimento',
                    text: `<p>Em Desenvolvimento`
                };
            },
        }

        const buttons = document.querySelectorAll('button.help-icon[data-help-text]');
        buttons.forEach(btn => {
            btn.dataset.helpTextOriginal = btn.dataset.helpText;
            btn.dataset.helpTitleOriginal = btn.dataset.helpTitle;
        });

        function updateButton(btn, data) {
            if (!data) {
                data = { title: btn.dataset.helpTitleOriginal, text: btn.dataset.helpTextOriginal };
            }
            btn.dataset.helpTitle = data.title || '';
            btn.dataset.helpText = data.text || '';
            btn.dataset.bsTitle = data.title || '';
            btn.dataset.bsContent = data.text || '';
            const pop = bootstrap.Popover.getOrCreateInstance(btn);
            pop.setContent({ '.popover-header': data.title || '', '.popover-body': data.text || '' });
        }

        function updateHelps() {
            buttons.forEach(btn => {
                const section = btn.closest('section');
                const cfgFn = section && helpConfigs[section.id];
                const data = cfgFn && cfgFn();
                updateButton(btn, data);
            });
        }

        ['HYLN', 'HYBR', 'HYRD', 'HYCM', 'HYBU', 'HYCP', 'HYAF', 'HYAFP', 'HYBT', 'HYPE', 'HYAS', 'HYASP', 'HYPM', 'HYOPC', 'HYMO', 'MOLN', 'MOTP', 'MOTT', 'MOFQ', 'MOPT',
            'MOPL', 'MOCP', 'MOCPP', 'MOPC', 'MOPP', 'MOOPC', 'MOCR', 'HYCR', 'HYVA', 'VALN', 'VAPT', 'VAECP', 'VASCP', 'VAPM', 'HYPL', 'PLDE', 'PLBU', 'PLGU', 'PLFU'].forEach(id => {
                document.getElementById(id)?.addEventListener('change', updateHelps);
            });

        updateHelps();
    });
</script>

<script src="/Layout/Galeria/Galeria.min.js"></script>
<script src="/Layout/Galeria/FiltrarPorURL.min.js"></script>

<section id="GrupoHYLN">
    <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="HYLN">Linha do Redutor:
        <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover" data-bs-title=""
            data-bs-content=""></button>
    </label>
    <select class="cssC" id="HYLN" name="HYLN">
    </select>
</section>


<section id="GrupoHYBR">
    <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="HYBR">Tamanho do Redutor:
        <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover" data-bs-title=""
            data-bs-content=""></button>
    </label>
    <select class="cssC" id="HYBR" name="HYBR">
    </select>
</section>


<section id="GrupoHYRD">
    <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="HYRD">Redução do Redutor:
        <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover" data-bs-title=""
            data-bs-content=""></button>
    </label>
    <select class="cssC" id="HYRD" name="HYRD" disabled>
    </select>
</section>


<section id="GrupoHYCM">
    <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="HYCM">Tamanho da Carcaça ou Eixo de
        Entrada do Redutor:
        <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover" data-bs-title=""
            data-bs-content=""></button>
    </label>
    <select class="cssC" id="HYCM" name="HYCM">
    </select>


    <div class="subgrupo">

        <section id="GrupoHYBU" style="display: none;">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="HYBU">Bucha de Redução do
                Redutor:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="HYBU" name="HYBU" disabled>
            </select>
        </section>
    </div>
</section>


<section id="GrupoHYCP">
    <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="HYCP">Forma Construtiva do Redutor:
        <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover" data-bs-title=""
            data-bs-content=""></button>
    </label>
    <select class="cssC" id="HYCP" name="HYCP">
    </select>
</section>


<section id="GrupoHYAF" class="grupo-condicional">
    <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="HYAF">Acessório de Fixação do
        Redutor:
        <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover" data-bs-title=""
            data-bs-content=""></button>
    </label>
    <select class="cssC" id="HYAF" name="HYAF">
    </select>


    <div class="subgrupo" style="display: none;">

        <section id="GrupoHYAFP" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="HYAFP">Posição do Acessório
                de Fixação:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="HYAFP" name="HYAFP">
                <option value="A" selected>DIREITA</option>
                <option value="B">ESQUERDA</option>
            </select>
        </section>


        <section id="GrupoHYBT" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="HYBT">Posição do Braço de
                Torque:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="HYBT" name="HYBT">
                <option value="1" selected>1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>
        </section>


        <section id="GrupoHYPE" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="HYPE">Posição dos Pés do
                Redutor:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="HYPE" name="HYPE">
                <option value="PB">ESQUERDA</option>
                <option value="PA">DIREITA</option>
                <option value="PV">INFERIOR</option>
            </select>
        </section>
    </div>
</section>


<section id="GrupoHYAS" class="grupo-condicional">
    <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="HYAS">Acessório de Saída do Redutor:
        <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover" data-bs-title=""
            data-bs-content=""></button>
    </label>
    <select class="cssC" id="HYAS" name="HYAS">
    </select>


    <div class="subgrupo" style="display: none;">

        <section id="GrupoHYASP" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="HYASP">Posição do Acessório
                de Saída:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="HYASP" name="HYASP">
                <option value="A" selected>DIREITA</option>
                <option value="B">ESQUERDA</option>
            </select>
        </section>
    </div>
</section>


<section id="GrupoHYPM" class="grupo-condicional" style="display: none;">
    <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="HYPM">Posição de Montagem do
        Redutor:
        <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover" data-bs-title=""
            data-bs-content=""></button>
    </label>
    <select class="cssC" id="HYPM" name="HYPM">
    </select>
</section>


<section id="GrupoHYOPC">
    <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="HYOPC_NAO">Itens Opcionais do
        Redutor:
        <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover" data-bs-title=""
            data-bs-content=""></button>
    </label>
    <div id="dropdownHYOPC" class="dropdown-checkbox" style="max-width:400px; margin: 0 auto;">
        <div class="dropdown-button cssC" onclick="toggleDropdown(this)">NÃO</div>
        <div class="dropdown-list"
            style="display:none; border: 1px solid #ec4115; max-height: 180px; overflow-y: auto; border-radius: 6px; background: white; padding: 10px; margin-top: 4px;">
            <div id="checklistHYOPC" style="display:flex; flex-direction:column; gap:6px; text-align:left;">
                <label><input type="checkbox" id="HYOPC_NAO" name="HYOPC" value="NÃO" checked> NÃO</label>
                <label><input type="checkbox" name="HYOPC" value="BLS"> BLINDADO</label>
                <label><input type="checkbox" name="HYOPC" value="ACOR"> PINTURA ANTICORROSIVA</label>
                <label><input type="checkbox" name="HYOPC" value="PINTCZ"> PINTURA CINZA</label>
            </div>
        </div>
        <input type="hidden" id="HYOPC" name="HYOPC" value="NÃO">
    </div>
</section>


<section id="GrupoHYMO" class="grupo-condicional">
    <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="HYMO">Com Motor:
        <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover" data-bs-title=""
            data-bs-content=""></button>
    </label>
    <select class="cssC" id="HYMO" name="HYMO">
        <option value="N">NÃO</option>
        <option value="S">SIM</option>
    </select>


    <div class="subgrupo" style="display: none;">

        <section id="GrupoMOLN" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="MOLN">Linha do Motor:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="MOLN" name="MOLN">

            </select>
        </section>


        <section id="GrupoMOTP" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="MOTP">Tipo do Motor:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="MOTP" name="MOTP">

            </select>
        </section>


        <section id="GrupoMOTT" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="MOTT">Tensão do Motor:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="MOTT" name="MOTT">

            </select>
        </section>


        <section id="GrupoMOFQ" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="MOFQ">Frequência do Motor:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="MOFQ" name="MOFQ">

            </select>
        </section>


        <section id="GrupoMOPT" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="MOPT">Potência do
                Motor:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="MOPT" name="MOPT">

            </select>
        </section>


        <section id="GrupoMOPL" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="MOPL">Polaridade do Motor:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="MOPL" name="MOPL">

            </select>
        </section>


        <section id="GrupoMOCP" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="MOCP">Forma Construtiva do
                Motor:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="MOCP" name="MOCP">

            </select>


            <div class="SubgrupoMOCP" style="display: none;">
                <section id="GrupoMOCPP" class="subgrupo subgrupo-aninhado grupo-condicional">
                    <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="MOCPP">Posição dos
                        Pés do Motor:
                        <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                            data-bs-title="" data-bs-content=""></button>
                    </label>
                    <select class="cssC" id="MOCPP" name="MOCPP">

                    </select>
                </section>
            </div>
        </section>


        <section id="GrupoMOPC" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="MOPC">Posição da Caixa de
                Ligação ou de Montagem do Motor:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="MOPC" name="MOPC">

            </select>
        </section>


        <section id="GrupoMOPP" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="MOPP">Posição do Prensa
                Cabo:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="MOPP" name="MOPP">

            </select>
        </section>


        <section id="GrupoMOOPC" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="MOOPC_NAO">Itens Opcionais
                do Motor:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <div id="dropdownMOOPC" class="dropdown-checkbox" style="max-width:400px; margin: 0 auto;">
                <div class="dropdown-button cssC" onclick="toggleDropdown(this)">NÃO</div>
                <div class="dropdown-list"
                    style="display:none; border: 1px solid #ec4115; max-height: 180px; overflow-y: auto; border-radius: 6px; background: white; padding: 10px; margin-top: 4px;">
                    <div id="checklistMOOPC" style="display:flex; flex-direction:column; gap:6px; text-align:left;">
                        <label><input type="checkbox" id="MOOPC_NAO" name="MOOPC" value="NÃO" checked> NÃO</label>
                        <label><input type="checkbox" name="MOOPC" value="ACOR"> PINTURA ANTICORROSIVA</label>
                        <label><input type="checkbox" name="MOOPC" value="PINTCZ"> PINTURA CINZA</label>
                        <label><input type="checkbox" name="MOOPC" value="VF"> VENTILAÇÃO FORÇADA</label>
                        <label><input type="checkbox" name="MOOPC" value="CR"> CONTRA RECUO</label>
                    </div>
                </div>
                <input type="hidden" id="MOOPC" name="MOOPC" value="NÃO">
            </div>


            <div class="SubgrupoMOOPC" style="display: none;">
                <section id="GrupoMOCR" class="subgrupo subgrupo-aninhado grupo-condicional">
                    <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="MOCR">Sentido de
                        Giro do Motor:
                        <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                            data-bs-title="" data-bs-content=""></button>
                    </label>
                    <select class="cssC" id="MOCR" name="MOCR">
                        <option value="H">HORÁRIO</option>
                        <option value="AH">ANTI-HORÁRIO</option>
                    </select>
                </section>


                <section id="GrupoHYCR" class="subgrupo subgrupo-aninhado grupo-condicional">
                    <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="HYCR">Sentido de
                        Giro do Redutor:
                        <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                            data-bs-title="" data-bs-content=""></button>
                    </label>
                    <select class="cssC" id="HYCR" name="HYCR">

                    </select>
                </section>
            </div>
        </section>
</section>


<section id="GrupoHYVA" class="grupo-condicional">
    <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="HYVA">Com Variador (Apenas B5):
        <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover" data-bs-title=""
            data-bs-content=""></button>
    </label>
    <select class="cssC" id="HYVA" name="HYVA">
        <option value="N">NÃO</option>
        <option value="S">SIM</option>
    </select>


    <div class="subgrupo" style="display: none;">

        <section id="GrupoVALN" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="VALN">Linha do Variador:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="VALN" name="VALN">

            </select>
        </section>


        <section id="GrupoVAPT" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="VAPT">Potência do Variador:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="VAPT" name="VAPT">

            </select>
        </section>


        <section id="GrupoVAECP" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="VAECP">Forma Construtiva da
                Entrada do Variador:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="VAECP" name="VAECP">
                <option value="B5">B5</option>
            </select>


            <div class="subgrupo subgrupo-aninhado">
                <section id="GrupoVASCP" class="grupo-condicional">
                    <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="VASCP">Forma
                        Construtiva da Saída do Variador:
                        <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                            data-bs-title="" data-bs-content=""></button>
                    </label>
                    <select class="cssC" id="VASCP" name="VASCP">

                    </select>
                </section>
            </div>
        </section>


        <section id="GrupoVAPM" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="VAPM">Posição de Montagem do
                Variador:</label>
            <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="VAPM" name="VAPM">
                <option value="B3">B3</option>
                <option value="B5">B5</option>
                <option value="V6">V6</option>
            </select>
        </section>
    </div>
</section>


<section id="GrupoHYPL" class="grupo-condicional">
    <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="HYPL">Adaptação para Servomotor
        (B14):
        <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover" data-bs-title=""
            data-bs-content=""></button>
    </label>
    <select class="cssC" id="HYPL" name="HYPL">
        <option value="N">NÃO</option>
        <option value="S">SIM</option>
    </select>


    <div class="subgrupo" style="display: none;">

        <section id="GrupoPLDE" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="PLDE">Diâmetro do Eixo do
                Servomotor:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="PLDE" name="PLDE"></select>


            <div class="subgrupo subgrupo-aninhado">
                <section id="GrupoPLBU" class="grupo-condicional">
                    <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="PLBU">Bucha de
                        Redução da Adaptação:
                        <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                            data-bs-title="" data-bs-content=""></button>
                    </label>
                    <select class="cssC" id="PLBU" name="PLBU"></select>
                </section>
            </div>
        </section>


        <section id="GrupoPLGU" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="PLGU">Guia da Flange da
                Adaptação:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="PLGU" name="PLGU"></select>
        </section>


        <section id="GrupoPLFU" class="grupo-condicional">
            <label class="cssB d-flex align-items-center gap-1 justify-content-center" for="PLFU">Furação do Guia da
                Flange da Adaptação:
                <button class="help-icon" data-help-title="" data-help-text="" data-help-class="perm-popover"
                    data-bs-title="" data-bs-content=""></button>
            </label>
            <select class="cssC" id="PLFU" name="PLFU"></select>
        </section>
    </div>
</section>

</div>
</section>

<script>
    async function carregarHYLN() {
        const hylnSelect = document.getElementById('HYLN');

        const response = await fetch('/Paginas/Seletores/Configuradores/HY/HYLN.php');
        const optionsHTML = await response.text();

        hylnSelect.innerHTML = optionsHTML;

        hylnSelect.value = ''
        hylnSelect.disabled = false;

        hylnSelect.dispatchEvent(new Event('change'));
    }

    document.addEventListener('DOMContentLoaded', () => {
        carregarHYLN();
    });

    async function carregarHYBR() {
        const hylnSelect = document.getElementById('HYLN');
        const hybrSelect = document.getElementById('HYBR');
        const grupoHYBR = document.getElementById('GrupoHYBR');

        const hyln = hylnSelect.value;

        const response = await fetch(`/Paginas/Seletores/Configuradores/HY/HYBR.php?HYLN=${encodeURIComponent(hyln)}`);
        const optionsHTML = await response.text();

        hybrSelect.innerHTML = optionsHTML;
        grupoHYBR.style.display = 'block';
        hybrSelect.disabled = false;
        hybrSelect.value = '';

        hybrSelect.onchange = carregarHYRD;

        carregarHYRD();
    }

    const hylnSelect = document.getElementById('HYLN');
    if (hylnSelect) {
        hylnSelect.addEventListener('change', carregarHYBR);
        hylnSelect.addEventListener('change', carregarHYOPC);
    }

    const hybrSelect = document.getElementById('HYBR');
    if (hybrSelect) {
        hybrSelect.addEventListener('change', carregarHYRD);
    }

    async function carregarHYRD() {
        const hyln = document.getElementById('HYLN')?.value;
        const hybr = document.getElementById('HYBR')?.value;
        const hyrdSelect = document.getElementById('HYRD');
        const grupoHYRD = document.getElementById('GrupoHYRD');

        const response = await fetch(`/Paginas/Seletores/Configuradores/HY/HYRD.php?HYLN=${encodeURIComponent(hyln)}&HYBR=${encodeURIComponent(hybr)}`);

        const optionsHTML = await response.text();
        hyrdSelect.innerHTML = optionsHTML;
        grupoHYRD.style.display = 'block';
        hyrdSelect.disabled = false;
        hyrdSelect.value = '';
    }

    async function carregarHYCM() {
        const hyln = document.getElementById('HYLN')?.value;
        const hybr = document.getElementById('HYBR')?.value;
        const hyrd = document.getElementById('HYRD')?.value;
        const grupoHYCM = document.getElementById('GrupoHYCM');
        const hycmSelect = document.getElementById('HYCM');

        const response = await fetch(`/Paginas/Seletores/Configuradores/HY/HYCM.php?HYLN=${encodeURIComponent(hyln)}&HYBR=${encodeURIComponent(hybr)}&HYRD=${encodeURIComponent(hyrd)}`);
        const optionsHTML = await response.text();
        hycmSelect.innerHTML = optionsHTML;

        grupoHYCM.style.display = 'block';
        hycmSelect.disabled = false;
        hycmSelect.value = '';

        const subgrupoHYBU = grupoHYCM.querySelector('.subgrupo');
        if (subgrupoHYBU) {

            subgrupoHYBU.style.display = 'none';

            hycmSelect.addEventListener('change', () => {
                subgrupoHYBU.style.display = hycmSelect.value ? 'block' : 'none';
            });
        }
    }

    async function carregarHYBU() {
        const hyln = document.getElementById('HYLN')?.value;
        const hybr = document.getElementById('HYBR')?.value;
        const hyrd = document.getElementById('HYRD')?.value;
        const hycm = document.getElementById('HYCM')?.value;
        const hycp = document.getElementById('HYCP')?.value || '';
        const grupoHYBU = document.getElementById('GrupoHYBU');
        const hybuSelect = document.getElementById('HYBU');

        const response = await fetch(`/Paginas/Seletores/Configuradores/HY/HYBU.php?HYLN=${encodeURIComponent(hyln)}&HYBR=${encodeURIComponent(hybr)}&HYRD=${encodeURIComponent(hyrd)}&HYCM=${encodeURIComponent(hycm)}&HYCP=${encodeURIComponent(hycp)}`);

        const optionsHTML = await response.text();
        hybuSelect.innerHTML = optionsHTML;

        const deveExibirBucha = hyln !== '1.R' && !hycm.includes('EE');
        const subgrupoHYBU = document.querySelector('#GrupoHYCM .subgrupo');
        grupoHYBU.style.display = deveExibirBucha ? 'block' : 'none';

        if (subgrupoHYBU) {
            subgrupoHYBU.style.display = deveExibirBucha ? 'block' : 'none';
        }

        hybuSelect.disabled = false;

        const optN = hybuSelect.querySelector('option[value="N"]');
        if (optN) {
            hybuSelect.value = 'N';
        } else if (hybuSelect.options.length > 0) {
            hybuSelect.selectedIndex = 0;
        }

        hybuSelect.dispatchEvent(new Event('change'));

        carregarVisibilidadeBucha();
    }

    const hyrdSelect = document.getElementById('HYRD');
    if (hyrdSelect) hyrdSelect.addEventListener('change', carregarHYCM);

    const hycmSelect = document.getElementById('HYCM');
    if (hycmSelect) {
        hycmSelect.addEventListener('change', carregarHYBU);

        hycmSelect.addEventListener('change', () => {
            const grupoHYCP = document.getElementById('GrupoHYCP');
            const hycpSelect = document.getElementById('HYCP');

            if (grupoHYCP && hycpSelect) {
                if (hycmSelect.value.includes('EE')) {
                    grupoHYCP.style.display = 'none';
                    hycpSelect.value = '';
                } else {
                    grupoHYCP.style.display = 'block';
                }
            }
        });
    }

    const hybuSelect = document.getElementById('HYBU');
    if (hybuSelect) hybuSelect.addEventListener('change', carregarHYCP);
    if (hybuSelect) hybuSelect.addEventListener('change', carregarHYAF);

    function carregarVisibilidadeBucha() {
        const hyln = document.getElementById('HYLN')?.value;
        const hycm = document.getElementById('HYCM')?.value;
        const grupoHYBU = document.getElementById('GrupoHYBU');
        if (grupoHYBU) {
            const deveExibir = hyln !== '1.R' && !hycm.includes('EE');
            grupoHYBU.style.display = deveExibir ? 'block' : 'none';
        }
    }

    async function carregarHYCP() {
        const hyln = document.getElementById('HYLN')?.value;
        const hybr = document.getElementById('HYBR')?.value;
        const hycm = document.getElementById('HYCM')?.value;
        const hyrd = document.getElementById('HYRD')?.value;
        const hyas = document.getElementById('HYAS')?.value;
        const hyaf = document.getElementById('HYAF')?.value;
        const hycpSelect = document.getElementById('HYCP');

        const response = await fetch(`/Paginas/Seletores/Configuradores/HY/HYCP.php?HYLN=${encodeURIComponent(hyln)}&HYBR=${encodeURIComponent(hybr)}&HYCM=${encodeURIComponent(hycm)}&HYRD=${encodeURIComponent(hyrd)}&HYAS=${encodeURIComponent(hyas)}&HYAF=${encodeURIComponent(hyaf)}`);
        const optionsHTML = await response.text();
        hycpSelect.innerHTML = optionsHTML;
        hycpSelect.disabled = false;
        hycpSelect.value = '';

        carregarVisibilidadeBucha();
    }

    const hycpSelect = document.getElementById('HYCP');
    if (hycpSelect) {
        hycpSelect.addEventListener('change', () => {
            const grupoHYBU = document.getElementById('GrupoHYBU');
            const hybuSelect = document.getElementById('HYBU');
            if (!hybuSelect || !grupoHYBU) return;
            const valorSelecionado = hycpSelect.value;
            grupoHYBU.style.display = valorSelecionado.includes("EE") ? 'none' : 'block';
        });

        hycpSelect.addEventListener('change', carregarHYAF);
    }

    async function carregarHYAF() {
        const hyln = document.getElementById('HYLN')?.value;
        const hybr = document.getElementById('HYBR')?.value;
        const hycp = document.getElementById('HYCP')?.value || 'N';
        const grupoHYAF = document.getElementById('GrupoHYAF');
        const hyafSelect = document.getElementById('HYAF');

        const response = await fetch(`/Paginas/Seletores/Configuradores/HY/HYAF.php?HYLN=${encodeURIComponent(hyln)}&HYBR=${encodeURIComponent(hybr)}`);
        const optionsHTML = await response.text();
        hyafSelect.innerHTML = optionsHTML;

        grupoHYAF.style.display = 'block';
        hyafSelect.disabled = false;

        const optF105 = hyafSelect.querySelector('option[value="F105"]');
        const optN = hyafSelect.querySelector('option[value="N"]');

        if (hyln === '1.M' && hybr === '211A' && optF105) {
            hyafSelect.value = 'F105';
        } else if (optN) {
            hyafSelect.value = 'N';
        } else if (hyafSelect.options.length > 0) {
            hyafSelect.selectedIndex = 0;
        }

        hyafSelect.dispatchEvent(new Event('change'));

        carregarHYAS();
        carregarVisibilidadeBucha();
    }

    function carregarHYAFP() {
        const hyln = document.getElementById('HYLN')?.value;
        const hyafSelect = document.getElementById('HYAF');
        const grupoHYAFP = document.getElementById('GrupoHYAFP');
        const hyafpSelect = document.getElementById('HYAFP');
        const subgrupoHYAF = document.querySelector('#GrupoHYAF .subgrupo');

        const valor = hyafSelect.value;

        const deveExibirAFP = (hyln === '1.R' || hyln === '1.X') && valor !== 'N' && valor !== 'PE';
        const deveExibirSubgrupo = deveExibirAFP || valor === 'PE';

        grupoHYAFP.style.display = deveExibirAFP ? 'block' : 'none';
        hyafpSelect.value = deveExibirAFP ? 'A' : '';

        if (subgrupoHYAF) {
            subgrupoHYAF.style.display = deveExibirSubgrupo ? 'block' : 'none';
        }

        carregarHYBT();
    }

    function carregarHYBT() {
        const hyafSelect = document.getElementById('HYAF');
        const hyln = document.getElementById('HYLN')?.value;
        const hybr = document.getElementById('HYBR')?.value;
        const grupoHYBT = document.getElementById('GrupoHYBT');
        const hybtSelect = document.getElementById('HYBT');

        const valoresPermitidos = ["22S", "32S", "33S", "42A", "43A", "52A", "53A", "62A", "63A", "93C", "94C"];
        const deveExibir = (
            hyafSelect.value === "BT" &&
            (
                (hyln === "1.X" && valoresPermitidos.includes(hybr)) ||
                hyln === "1.R"
            )
        );

        if (deveExibir) {
            grupoHYBT.style.display = 'block';
            hybtSelect.value = '1';
        } else {
            grupoHYBT.style.display = 'none';
            hybtSelect.value = '';
        }

        carregarHYPE();
    }

    function carregarHYPE() {
        const hyafSelect = document.getElementById('HYAF');
        const grupoHYPE = document.getElementById('GrupoHYPE');
        const hypeSelect = document.getElementById('HYPE');

        if (hyafSelect.value === "PE") {
            grupoHYPE.style.display = 'block';
            hypeSelect.value = 'PB';
        } else {
            grupoHYPE.style.display = 'none';
            hypeSelect.value = '';
        }
    }

    const hyafSelect = document.getElementById('HYAF');
    if (hyafSelect) hyafSelect.addEventListener('change', () => {
        carregarHYAFP();
        carregarHYBT();
        carregarHYPE();
    });

    async function carregarHYAS() {
        const hyln = document.getElementById('HYLN')?.value;
        const hybr = document.getElementById('HYBR')?.value;
        const hycm = document.getElementById('HYCM')?.value;
        const hycp = document.getElementById('HYCP')?.value || 'N';
        const hyaf = document.getElementById('HYAF')?.value;
        const grupoHYAS = document.getElementById('GrupoHYAS');
        const hyasSelect = document.getElementById('HYAS');

        const response = await fetch(`/Paginas/Seletores/Configuradores/HY/HYAS.php?HYLN=${encodeURIComponent(hyln)}&HYBR=${encodeURIComponent(hybr)}&HYCM=${encodeURIComponent(hycm)}&HYCP=${encodeURIComponent(hycp)}&HYAF=${encodeURIComponent(hyaf)}`);

        const optionsHTML = await response.text();
        hyasSelect.innerHTML = optionsHTML;

        grupoHYAS.style.display = 'block';
        hyasSelect.disabled = false;

        const optN = hyasSelect.querySelector('option[value="N"]');
        if (optN) {
            hyasSelect.value = 'N';
        } else if (hyasSelect.options.length > 0) {
            hyasSelect.selectedIndex = 0;
        }

        hyasSelect.dispatchEvent(new Event('change'));

        carregarVisibilidadeBucha();
        carregarHYPM();
        carregarHYOPC();
        validarHYOPC();

    }

    const hyasSelect = document.getElementById('HYAS');
    if (hyasSelect) {
        hyasSelect.addEventListener('change', carregarHYASP);
    }

    function carregarHYASP() {
        const hyasSelect = document.getElementById('HYAS');
        const hyln = document.getElementById('HYLN')?.value;
        const grupoHYASP = document.getElementById('GrupoHYASP');
        const hyaspSelect = document.getElementById('HYASP');
        const subgrupoHYAS = document.querySelector('#GrupoHYAS .subgrupo');

        const valor = hyasSelect.value;
        const deveExibir = (hyln === '1.R' || hyln === '1.X') && valor !== 'N' && valor !== 'ED';

        if (deveExibir) {
            grupoHYASP.style.display = 'block';
            if (subgrupoHYAS) subgrupoHYAS.style.display = 'block';

            hyaspSelect.innerHTML = `
            <option value="A" selected>DIREITA</option>
            <option value="B">ESQUERDA</option>
        `;
            hyaspSelect.value = 'A';
        } else {
            grupoHYASP.style.display = 'none';
            hyaspSelect.value = '';
            if (subgrupoHYAS) subgrupoHYAS.style.display = 'none';
        }

        carregarHYPM();
        carregarHYOPC();
        validarHYOPC();
    }

    const hypmSelect = document.getElementById('HYPM');
    if (hypmSelect) {
        hypmSelect.addEventListener('change', carregarHYOPC);
    }

    async function carregarHYPM() {
        const hyln = document.getElementById('HYLN')?.value;
        const hybr = document.getElementById('HYBR')?.value;
        const grupoQUPM = document.getElementById('GrupoHYPM');
        const hypmSelect = document.getElementById('HYPM');

        if (hyln === "1.M" || hyln === "1.R") {
            grupoQUPM.style.display = 'none';
            hypmSelect.value = '';
            return;
        }

        const response = await fetch(`/Paginas/Seletores/Configuradores/HY/HYPM.php?HYLN=${encodeURIComponent(hyln)}&HYBR=${encodeURIComponent(hybr)}`);
        const optionsHTML = await response.text();
        hypmSelect.innerHTML = optionsHTML;

        grupoQUPM.style.display = 'block';

        if (hyln === "1.P" && hypmSelect.querySelector('option[value="H1"]')) {
            hypmSelect.value = 'H1';
        } else if (hypmSelect.querySelector('option[value="B3"]')) {
            hypmSelect.value = 'B3';
        } else if (hypmSelect.options.length > 0) {
            hypmSelect.selectedIndex = 0;
        }

        hypmSelect.dispatchEvent(new Event('change'));
        carregarHYOPC();
        validarHYOPC();

    }

    function carregarHYOPC() {
        const hyln = document.getElementById('HYLN')?.value;
        const hybr = document.getElementById('HYBR')?.value;
        const grupoHYOPC = document.getElementById('GrupoHYOPC');

        grupoHYOPC.style.display = 'block';

        const opcaoBLS = document.querySelector('input[name="HYOPC"][value="BLS"]')?.closest('label');
        const permitidosBLS = ["862C", "863C", "1002", "1003", "1102", "1103", "FC71", "FC72", "FC73", "FC81", "FC82", "FC83", "83C", "84C", "93C", "94C", "103", "104", "113", "114"];

        if (opcaoBLS) {
            const deveExibir = permitidosBLS.includes(hybr);
            opcaoBLS.style.display = deveExibir ? 'block' : 'none';

            if (!deveExibir) {
                const checkbox = opcaoBLS.querySelector('input');
                if (checkbox) checkbox.checked = false;
            }
        }

        validarHYOPC();
        carregarHYMO();
        carregarHYVA();
        carregarHYPL();
    }

    function validarHYOPC() {
        const checkboxes = document.querySelectorAll('#checklistHYOPC input[type="checkbox"]');
        let selecionados = Array.from(checkboxes)
            .filter(cb => cb.checked)
            .map(cb => cb.value);

        if (selecionados.includes("NÃO") && selecionados.length > 1) {
            document.querySelector('input[name="HYOPC"][value="NÃO"]').checked = false;
            selecionados = selecionados.filter(v => v !== "NÃO");
        }

        if (selecionados.length === 0) {
            document.querySelector('input[name="HYOPC"][value="NÃO"]').checked = true;
            selecionados = ["NÃO"];
        }

        if (selecionados.includes("ACOR") && selecionados.includes("PINTCZ")) {
            document.querySelector('input[name="HYOPC"][value="ACOR"]').checked = false;
            selecionados = selecionados.filter(v => v !== "ACOR");
        }

        document.getElementById('HYOPC').value = selecionados.join(',');

        const nomesVisiveis = selecionados.map(valor => {
            const label = Array.from(document.querySelectorAll('#checklistHYOPC label')).find(lbl =>
                lbl.querySelector(`input[value="${valor}"]`)
            );
            return label ? label.textContent.trim() : valor;
        });

        document.querySelector('#dropdownHYOPC .dropdown-button').textContent = nomesVisiveis.join(', ');

        document.getElementById('HYOPC').dispatchEvent(new Event('change'));
    }

    document.querySelectorAll('#checklistHYOPC input[type="checkbox"]').forEach(cb => {
        cb.addEventListener('change', validarHYOPC);
    });

    const hyopcSelect = document.getElementById('HYOPC');
    if (hyopcSelect) {
        hyopcSelect.addEventListener('change', () => {
            setTimeout(() => {
                carregarHYMO();
                carregarHYVA();
                carregarHYPL();
            }, 10);
        });
    }

    window.toggleDropdown = function (button) {
        const list = button.nextElementSibling;
        list.style.display = list.style.display === 'block' ? 'none' : 'block';
    };

    document.addEventListener('click', function (e) {
        document.querySelectorAll('.dropdown-checkbox').forEach(dropdown => {
            if (!dropdown.contains(e.target)) {
                dropdown.querySelector('.dropdown-list').style.display = 'none';
            }
        });
    });

    window.addEventListener('load', () => {
        const grupoHYOPC = document.getElementById('GrupoHYOPC');
        if (grupoHYOPC?.style.display === 'block') {
            carregarHYMO();
            carregarHYVA();
            carregarHYPL();
        }
    });

    function carregarHYMO() {
        const hycm = document.getElementById('HYCM')?.value;
        const hycp = document.getElementById('HYCP')?.value;
        const hypl = document.getElementById('HYPL')?.value;
        const hymoSelect = document.getElementById('HYMO');
        const grupoHYMO = document.getElementById('GrupoHYMO');

        const permitirS = (
            hypl === "N" &&
            !hycm.includes("EE") &&
            hycp !== "B"
        );

        const valorAtual = hymoSelect.value;

        hymoSelect.innerHTML = '';
        hymoSelect.disabled = false;

        if (permitirS) {
            hymoSelect.appendChild(new Option("SIM", "S"));
        }

        hymoSelect.appendChild(new Option("NÃO", "N"));

        if (Array.from(hymoSelect.options).some(opt => opt.value === valorAtual)) {
            hymoSelect.value = valorAtual;
        } else {
            hymoSelect.value = "N";
        }

        grupoHYMO.style.display = 'block';
        hymoSelect.dispatchEvent(new Event('change'));

        carregarMOLN();
    }

    document.getElementById('HYCM')?.addEventListener('change', carregarHYMO);
    document.getElementById('HYCP')?.addEventListener('change', carregarHYMO);
    document.getElementById('HYPL')?.addEventListener('change', carregarHYMO);

    const hymoSelect = document.getElementById('HYMO');
    if (hymoSelect) {
        hymoSelect.addEventListener('change', carregarMOLN);
    }

    async function carregarMOLN() {
        const hymoSelect = document.getElementById('HYMO');
        const hycp = document.getElementById('HYCP')?.value;
        const hycm = document.getElementById('HYCM')?.value;
        const grupoMOLN = document.getElementById('GrupoMOLN');
        const molnSelect = document.getElementById('MOLN');
        const subgrupoHYMO = document.querySelector('#GrupoHYMO .subgrupo');

        if (hymoSelect.value === "S") {
            grupoMOLN.style.display = 'block';
            if (subgrupoHYMO) subgrupoHYMO.style.display = 'block';

            const response = await fetch(`/Paginas/Seletores/Configuradores/HY/MOLN.php?HYCM=${encodeURIComponent(hycm)}&HYCP=${encodeURIComponent(hycp)}`);

            const optionsHTML = await response.text();
            molnSelect.innerHTML = optionsHTML;

            molnSelect.style.display = 'block';
            molnSelect.disabled = false;
            molnSelect.dispatchEvent(new Event('change'));
        } else {
            grupoMOLN.style.display = 'none';
            if (subgrupoHYMO) subgrupoHYMO.style.display = 'none';
            molnSelect.style.display = 'none';
        }

        molnSelect.value = "";

        carregarMOTP();
        carregarMOOPC();
    }

    const molnSelect = document.getElementById('MOLN');
    if (molnSelect) {
        molnSelect.addEventListener('change', carregarMOTP);
        molnSelect.addEventListener('change', carregarMOOPC);
    }

    async function carregarMOTP() {
        const moln = document.getElementById('MOLN')?.value;
        const hycm = document.getElementById('HYCM')?.value;
        const hycp = document.getElementById('HYCP')?.value;
        const grupoMOTP = document.getElementById('GrupoMOTP');
        const motpSelect = document.getElementById('MOTP');

        const response = await fetch(`/Paginas/Seletores/Configuradores/HY/MOTP.php?MOLN=${encodeURIComponent(moln)}&HYCM=${encodeURIComponent(hycm)}&HYCP=${encodeURIComponent(hycp)}`);

        const optionsHTML = await response.text();
        motpSelect.innerHTML = optionsHTML;

        grupoMOTP.style.display = 'block';
        motpSelect.style.display = 'block';
        motpSelect.disabled = false;
        motpSelect.value = "";

        carregarMOTT();
    }

    const motpSelect = document.getElementById('MOTP');
    if (motpSelect) {
        motpSelect.addEventListener('change', carregarMOTT);
    }

    async function carregarMOTT() {
        const moln = document.getElementById('MOLN')?.value;
        const motp = document.getElementById('MOTP')?.value;
        const hycm = document.getElementById('HYCM')?.value;
        const hycp = document.getElementById('HYCP')?.value;
        const grupoMOTT = document.getElementById('GrupoMOTT');
        const mottSelect = document.getElementById('MOTT');
        const subgrupoHYMO = document.querySelector('#GrupoHYMO .subgrupo');

        const response = await fetch(`/Paginas/Seletores/Configuradores/HY/MOTT.php?MOLN=${encodeURIComponent(moln)}&MOTP=${encodeURIComponent(motp)}&HYCM=${encodeURIComponent(hycm)}&HYCP=${encodeURIComponent(hycp)}`);

        const optionsHTML = await response.text();
        mottSelect.innerHTML = optionsHTML;

        grupoMOTT.style.display = 'block';
        mottSelect.style.display = 'block';
        mottSelect.disabled = false;
        mottSelect.value = '';

        carregarMOFQ();
    }

    const mottSelect = document.getElementById('MOTT');
    if (mottSelect) {
        mottSelect.addEventListener('change', carregarMOFQ);
    }

    async function carregarMOFQ() {
        const moln = document.getElementById('MOLN')?.value;
        const motp = document.getElementById('MOTP')?.value;
        const mott = document.getElementById('MOTT')?.value;
        const hycm = document.getElementById('HYCM')?.value;
        const hycp = document.getElementById('HYCP')?.value;
        const grupoMOFQ = document.getElementById('GrupoMOFQ');
        const mofqSelect = document.getElementById('MOFQ');

        const response = await fetch(
            `/Paginas/Seletores/Configuradores/HY/MOFQ.php?MOLN=${encodeURIComponent(moln)}&MOTP=${encodeURIComponent(motp)}&MOTT=${encodeURIComponent(mott)}&HYCM=${encodeURIComponent(hycm)}&HYCP=${encodeURIComponent(hycp)}`
        );

        const optionsHTML = await response.text();
        mofqSelect.innerHTML = optionsHTML;

        grupoMOFQ.style.display = 'block';
        mofqSelect.style.display = 'block';
        mofqSelect.disabled = false;
        mofqSelect.value = '';

        carregarMOPT();
    }

    const mofqSelect = document.getElementById('MOFQ');
    if (mofqSelect) {
        mofqSelect.addEventListener('change', carregarMOPT);
    }


    async function carregarMOPT() {
        const moln = document.getElementById('MOLN')?.value;
        const motp = document.getElementById('MOTP')?.value;
        const mott = document.getElementById('MOTT')?.value;
        const mofq = document.getElementById('MOFQ')?.value;
        const hycm = document.getElementById('HYCM')?.value;
        const hycp = document.getElementById('HYCP')?.value;
        const grupoMOPT = document.getElementById('GrupoMOPT');
        const moptSelect = document.getElementById('MOPT');

        const response = await fetch(`/Paginas/Seletores/Configuradores/HY/MOPT.php?MOLN=${encodeURIComponent(moln)}&MOTP=${encodeURIComponent(motp)}&MOTT=${encodeURIComponent(mott)}&MOFQ=${encodeURIComponent(mofq)}&HYCM=${encodeURIComponent(hycm)}&HYCP=${encodeURIComponent(hycp)}`
        );

        const optionsHTML = await response.text();
        moptSelect.innerHTML = optionsHTML;

        grupoMOPT.style.display = 'block';
        moptSelect.style.display = 'block';
        moptSelect.disabled = false;
        moptSelect.value = '';

        carregarMOPL();
    }

    const moptSelect = document.getElementById('MOPT');
    if (moptSelect) {
        moptSelect.addEventListener('change', carregarMOPL);
    }

    async function carregarMOPL() {
        const moln = document.getElementById('MOLN')?.value;
        const motp = document.getElementById('MOTP')?.value;
        const mott = document.getElementById('MOTT')?.value;
        const mofq = document.getElementById('MOFQ')?.value;
        const mopt = document.getElementById('MOPT')?.value;
        const hycm = document.getElementById('HYCM')?.value;
        const hycp = document.getElementById('HYCP')?.value;
        const grupoMOPL = document.getElementById('GrupoMOPL');
        const moplSelect = document.getElementById('MOPL');

        const response = await fetch(
            `/Paginas/Seletores/Configuradores/HY/MOPL.php?MOLN=${encodeURIComponent(moln)}&MOTP=${encodeURIComponent(motp)}&MOTT=${encodeURIComponent(mott)}&MOFQ=${encodeURIComponent(mofq)}&MOPT=${encodeURIComponent(mopt)}&HYCM=${encodeURIComponent(hycm)}&HYCP=${encodeURIComponent(hycp)}`
        );

        const optionsHTML = await response.text();
        moplSelect.innerHTML = optionsHTML;

        grupoMOPL.style.display = 'block';
        moplSelect.style.display = 'block';
        moplSelect.disabled = false;
        moplSelect.value = '';

        carregarMOCP();
    }

    const moplSelect = document.getElementById('MOPL');
    if (moplSelect) {
        moplSelect.addEventListener('change', carregarMOCP);
    }

    async function carregarMOCP() {
        const moln = document.getElementById('MOLN')?.value;
        const motp = document.getElementById('MOTP')?.value;
        const mott = document.getElementById('MOTT')?.value;
        const mofq = document.getElementById('MOFQ')?.value;
        const mopt = document.getElementById('MOPT')?.value;
        const mopl = document.getElementById('MOPL')?.value;
        const hycm = document.getElementById('HYCM')?.value;
        const hycp = document.getElementById('HYCP')?.value;
        const grupoMOCP = document.getElementById('GrupoMOCP');
        const mocpSelect = document.getElementById('MOCP');

        const response = await fetch(
            `/Paginas/Seletores/Configuradores/HY/MOCP.php?MOLN=${encodeURIComponent(moln)}&MOTP=${encodeURIComponent(motp)}&MOTT=${encodeURIComponent(mott)}&MOFQ=${encodeURIComponent(mofq)}&MOPT=${encodeURIComponent(mopt)}&MOPL=${encodeURIComponent(mopl)}&HYCM=${encodeURIComponent(hycm)}&HYCP=${encodeURIComponent(hycp)}`
        );

        const optionsHTML = await response.text();
        mocpSelect.innerHTML = optionsHTML;

        grupoMOCP.style.display = 'block';
        mocpSelect.style.display = 'block';
        mocpSelect.disabled = false;
        mocpSelect.value = hycp;
        mocpSelect.dispatchEvent(new Event('change'));

        carregarMOCPP();
        carregarMOPC();
    }

    function carregarMOCPP() {
        const moln = document.getElementById('MOLN')?.value;
        const mocp = document.getElementById('MOCP')?.value;
        const hycm = document.getElementById('HYCM')?.value;
        const grupoMOCPP = document.getElementById('GrupoMOCPP');
        const divSubgrupo = document.querySelector('.SubgrupoMOCP');
        const mocppSelect = document.getElementById('MOCPP');

        const deveExibir = moln !== "3.W" && ["B3", "B34", "B35"].includes(mocp);

        if (deveExibir) {

            mocppSelect.innerHTML = '';

            mocppSelect.innerHTML += '<option value="T" selected>Topo</option>';

            const bloqueado = moln === "2.I" && hycm === "56";
            if (!bloqueado) {
                mocppSelect.innerHTML += '<option value="D">Direita</option>';
                mocppSelect.innerHTML += '<option value="E">Esquerda</option>';
            }

            divSubgrupo.style.display = 'block';
            grupoMOCPP.style.display = 'block';
        } else {
            divSubgrupo.style.display = 'none';
            grupoMOCPP.style.display = 'none';
        }
        carregarMOPC();
    }

    const mocpSelect = document.getElementById('MOCP');
    if (mocpSelect) {

        mocpSelect.addEventListener('change', carregarMOCPP);
    }
    mocpSelect.addEventListener('change', carregarMOPC);

    function carregarMOPC() {
        const moln = document.getElementById('MOLN')?.value;
        const grupoMOPC = document.getElementById('GrupoMOPC');
        const mopcSelect = document.getElementById('MOPC');

        mopcSelect.innerHTML = '';

        const isAPM = moln === "3.APM" || moln === "3.SPM";

        const rotulos = {
            "CX270": "270°",
            "CX180": "180°",
            "CX90": "90°",
            "CX0": "0°",
            "B3": "B3",
            "B6": "B6",
            "B7": "B7",
            "B8": "B8",
            "V5": "V5",
            "V6": "V6"
        };

        const opcoes = isAPM
            ? ["B3", "B6", "B7", "B8", "V5", "V6"]
            : ["CX270", "CX180", "CX90", "CX0"];

        const valorPadrao = isAPM ? "B3" : "CX270";

        opcoes.forEach(valor => {
            const selected = valor === valorPadrao ? 'selected' : '';
            mopcSelect.innerHTML += `<option value="${valor}" ${selected}>${rotulos[valor]}</option>`;
        });

        grupoMOPC.style.display = 'block';
        mopcSelect.disabled = false;

        carregarMOPP();
    }

    const mopcSelect = document.getElementById('MOPC');
    if (mopcSelect) {

        mopcSelect.addEventListener('change', carregarMOPP);
    }

    function carregarMOPP() {
        const moln = document.getElementById('MOLN')?.value;
        const motp = document.getElementById('MOTP')?.value;
        const mocp = document.getElementById('MOCP')?.value;
        const grupoMOPP = document.getElementById('GrupoMOPP');
        const moppSelect = document.getElementById('MOPP');

        if (moln === "3.APM" || moln === "3.SPM") {
            grupoMOPP.style.display = 'none';
            return;
        }

        moppSelect.innerHTML = '';

        const opcoes = [
            { valor: "PC1", label: "1" },
            { valor: "PC2", label: "2" },
            { valor: "PC3", label: "3" },
            { valor: "PC4", label: "4" }
        ];

        opcoes.forEach(op => {
            const option = document.createElement('option');
            option.value = op.valor;
            option.textContent = op.label;
            moppSelect.appendChild(option);
        });

        let valorPadrao = "PC1";
        if (moln === "3.I" || (moln === "2.I" && motp === "T")) valorPadrao = "PC1";
        else if (moln === "2.I" && motp === "M") valorPadrao = "PC2";
        else if (moln === "3.W") valorPadrao = "PC3";

        moppSelect.value = valorPadrao;

        grupoMOPP.style.display = 'block';
        moppSelect.disabled = false;

        carregarMOOPC();
    }

    const moppSelect = document.getElementById('MOPP');
    if (moppSelect) {

        moppSelect.addEventListener('change', carregarMOOPC);
    }

    function carregarMOOPC() {
        const moln = document.getElementById('MOLN')?.value.trim();
        const hycm = document.getElementById('HYCM')?.value;
        const motp = document.getElementById('MOTP')?.value;
        const grupoMOPP = document.getElementById('GrupoMOPP');
        const grupoMOOPC = document.getElementById('GrupoMOOPC');
        const checklist = document.querySelectorAll('#checklistMOOPC input[type="checkbox"]');

        if (!grupoMOPP || grupoMOPP.style.display !== 'block' || !grupoMOOPC) {
            grupoMOOPC.style.display = 'none';
            return;
        }

        grupoMOOPC.style.display = 'block';

        checklist.forEach(cb => {
            const value = cb.value;
            let mostrar = true;

            if (["ACOR", "PINTCZ"].includes(value) && (moln === "3.APM" || moln === "3.SPM")) {
                mostrar = false;
            }

            if (value === "VF") {
                mostrar = (moln === "2.I" && ["63", "71"].includes(hycm)) ||
                    (moln === "3.I" && motp !== "F" && ["63", "71", "80", "90", "100-112", "132"].includes(hycm));
            }

            if (value === "CR") {
                mostrar = (moln === "3.W" && ["80", "90", "100-112", "132"].includes(hycm)) ||
                    (moln === "3.I" && ["80", "90", "100-112"].includes(hycm));
            }

            cb.closest('label').style.display = mostrar ? 'block' : 'none';

            if (!mostrar) cb.checked = false;
        });

        validarMOOPC();
        carregarMOCR();
    }

    const moopcSelect = document.getElementById('MOOPC');
    if (moopcSelect) {
        moopcSelect.addEventListener('change', carregarMOCR);
        moopcSelect.addEventListener('change', validarMOOPC);
    }

    function validarMOOPC() {
        const checkboxes = document.querySelectorAll('#checklistMOOPC input[type="checkbox"]');
        let selecionados = Array.from(checkboxes)
            .filter(cb => cb.checked)
            .map(cb => cb.value);

        if (selecionados.includes("NÃO") && selecionados.length > 1) {
            document.querySelector('input[name="MOOPC"][value="NÃO"]').checked = false;
            selecionados = selecionados.filter(v => v !== "NÃO");
        }

        if (selecionados.length === 0) {
            document.querySelector('input[name="MOOPC"][value="NÃO"]').checked = true;
            selecionados = ["NÃO"];
        }

        if (selecionados.includes("ACOR") && selecionados.includes("PINTCZ")) {
            document.querySelector('input[name="MOOPC"][value="ACOR"]').checked = false;
            selecionados = selecionados.filter(v => v !== "ACOR");
        }

        document.getElementById('MOOPC').value = selecionados.join(',');

        const nomesVisiveis = selecionados.map(valor => {
            const label = Array.from(document.querySelectorAll('#checklistMOOPC label')).find(lbl =>
                lbl.querySelector(`input[value="${valor}"]`)
            );
            return label ? label.textContent.trim() : valor;
        });

        document.querySelector('#dropdownMOOPC .dropdown-button').textContent = nomesVisiveis.join(', ');

        carregarMOCR();
    }

    document.getElementById('MOOPC').dispatchEvent(new Event('change'));

    document.addEventListener('DOMContentLoaded', () => {
        const checkboxes = document.querySelectorAll('#checklistMOOPC input[type="checkbox"]');
        checkboxes.forEach(cb => {
            cb.addEventListener('change', validarMOOPC);
        });
    });

    function carregarMOCR() {
        const grupoMOCR = document.getElementById('GrupoMOCR');
        const grupoHYCR = document.getElementById('GrupoHYCR');
        const subgrupoMOOPC = document.querySelector('.SubgrupoMOOPC');
        const mocrSelect = document.getElementById('MOCR');
        const moopc = document.getElementById('MOOPC')?.value || '';

        const crSelecionado = moopc.split(',').includes('CR');

        if (!crSelecionado) {
            subgrupoMOOPC.style.display = 'none';
            grupoMOCR.style.display = 'none';
            grupoHYCR.style.display = 'none';
            mocrSelect.value = '';
            return;
        }

        subgrupoMOOPC.style.display = 'block';
        grupoMOCR.style.display = 'block';
        grupoHYCR.style.display = 'none';

        mocrSelect.innerHTML = `
            < option value = "H" > HORÁRIO</option >
            <option value="AH">ANTI-HORÁRIO</option>
  `;

        mocrSelect.value = '';

        carregarHYCR();
    }

    const mocrSelect = document.getElementById('MOCR');
    if (mocrSelect) {
        carregarHYVA()
        mocrSelect.addEventListener('change', carregarHYCR);
    }

    async function carregarHYCR() {
        const hyln = document.getElementById('HYLN')?.value;
        const hybr = document.getElementById('HYBR')?.value;
        const mocr = document.getElementById('MOCR')?.value;
        const grupoHYCR = document.getElementById('GrupoHYCR');
        const hycrSelect = document.getElementById('HYCR');

        if (!mocr) {
            grupoHYCR.style.display = 'none';
            hycrSelect.value = '';
            return;
        }

        const response = await fetch(`/Paginas/Seletores/Configuradores/HY/HYCR.php?HYLN=${encodeURIComponent(hyln)}&HYBR=${encodeURIComponent(hybr)}&MOCR=${encodeURIComponent(mocr)}`);
        const optionsHTML = await response.text();

        hycrSelect.innerHTML = optionsHTML;
        if (optionsHTML.trim()) {
            hycrSelect.innerHTML = optionsHTML;
            grupoHYCR.style.display = 'block';
            hycrSelect.selectedIndex = 0;
            hycrSelect.dispatchEvent(new Event('change'));
        } else {
            grupoHYCR.style.display = 'none';
            hycrSelect.innerHTML = '';
        }

        if (hycrSelect.options.length > 0) {
            hycrSelect.selectedIndex = 0;
            hycrSelect.dispatchEvent(new Event('change'));
        }
    }

    function carregarHYVA() {
        const hypl = document.getElementById('HYPL')?.value;
        const hycm = document.getElementById('HYCM')?.value;
        const hycp = document.getElementById('HYCP')?.value;
        const hyvaSelect = document.getElementById('HYVA');
        const grupoHYVA = document.getElementById('GrupoHYVA');

        const permitirS = hypl === "N" && ["63", "71", "80", "90"].includes(hycm) && hycp === "B5";

        hyvaSelect.innerHTML = '';
        hyvaSelect.disabled = false;

        if (permitirS) hyvaSelect.appendChild(new Option("SIM", "S"));
        hyvaSelect.appendChild(new Option("NÃO", "N"));
        hyvaSelect.value = "N";

        grupoHYVA.style.display = 'block';

        hyvaSelect.dispatchEvent(new Event('change'));

        carregarVALN();
    }

    document.getElementById('HYCM')?.addEventListener('change', carregarHYVA);
    document.getElementById('HYCP')?.addEventListener('change', carregarHYVA);
    document.getElementById('HYPL')?.addEventListener('change', carregarHYVA);
    document.getElementById('HYVA')?.addEventListener('change', carregarVALN);

    async function carregarVALN() {
        const hyvaSelect = document.getElementById('HYVA');
        const grupoVALN = document.getElementById('GrupoVALN');
        const valnSelect = document.getElementById('VALN');
        const subgrupoHYVA = document.querySelector('#GrupoHYVA .subgrupo');

        if (hyvaSelect.value === "S") {
            grupoVALN.style.display = 'block';
            if (subgrupoHYVA) subgrupoHYVA.style.display = 'block';

            const response = await fetch(`/Paginas/Seletores/Configuradores/HY/VALN.php`);
            if (!response.ok) throw new Error('Erro ao buscar opções de VALN');
            const optionsHTML = await response.text();
            valnSelect.innerHTML = optionsHTML;
            valnSelect.style.display = 'block';
            valnSelect.disabled = false;
            valnSelect.value = '1.V';
            valnSelect.dispatchEvent(new Event('change'));
        } else {
            grupoVALN.style.display = 'none';
            if (subgrupoHYVA) subgrupoHYVA.style.display = 'none';
            valnSelect.style.display = 'none';
        }
    }

    document.getElementById('VALN')?.addEventListener('change', carregarVAPT);

    async function carregarVAPT() {
        const valn = document.getElementById('VALN')?.value;
        const hycm = document.getElementById('HYCM')?.value;
        const grupoVAPT = document.getElementById('GrupoVAPT');
        const vaptSelect = document.getElementById('VAPT');

        grupoVAPT.style.display = 'block';

        const response = await fetch(`/Paginas/Seletores/Configuradores/HY/VAPT.php?VALN=${encodeURIComponent(valn)}&HYCM=${encodeURIComponent(hycm)}`);
        if (!response.ok) throw new Error('Erro ao buscar opções de VAPT');
        const optionsHTML = await response.text();
        vaptSelect.innerHTML = optionsHTML;
        vaptSelect.disabled = false;
        vaptSelect.style.display = 'block';
        vaptSelect.dispatchEvent(new Event('change'));
    }

    document.getElementById('VAPT')?.addEventListener('change', carregarVAECP);

    function carregarVAECP() {
        const vapt = document.getElementById('VAPT')?.value;
        const grupoVAECP = document.getElementById('GrupoVAECP');
        const vaecpSelect = document.getElementById('VAECP');
        const subgrupoHYVA = document.querySelector('#GrupoHYVA .subgrupo');

        grupoVAECP.style.display = 'block';
        if (subgrupoHYVA) subgrupoHYVA.style.display = 'block';

        vaecpSelect.disabled = false;
        vaecpSelect.value = 'B5';
        vaecpSelect.dispatchEvent(new Event('change'));
    }

    document.getElementById('VAECP')?.addEventListener('change', carregarVASCP);

    async function carregarVASCP() {
        const valn = document.getElementById('VALN')?.value;
        const hycm = document.getElementById('HYCM')?.value;
        const vapt = document.getElementById('VAPT')?.value;
        const hymo = document.getElementById('HYMO')?.value;

        const grupoVASCP = document.getElementById('GrupoVASCP');
        const vascpSelect = document.getElementById('VASCP');
        const subgrupoVAECP = document.querySelector('#GrupoVAECP .subgrupo');

        grupoVASCP.style.display = 'block';
        if (subgrupoVAECP) subgrupoVAECP.style.display = 'block';

        const response = await fetch(`/Paginas/Seletores/Configuradores/HY/VASCP.php?VALN=${encodeURIComponent(valn)}&HYCM=${encodeURIComponent(hycm)}&VAPT=${encodeURIComponent(vapt)}&HYMO=${encodeURIComponent(hymo)}`);
        const optionsHTML = await response.text();
        vascpSelect.innerHTML = optionsHTML;
        vascpSelect.disabled = false;
        vascpSelect.style.display = 'block';

        const optionExists = Array.from(vascpSelect.options).some(opt => opt.value === hycm);
        vascpSelect.value = optionExists ? hycm : vascpSelect.options[0]?.value || '';

        caregarVAPM();
    }

    document.getElementById('VASCP')?.addEventListener('change', caregarVAPM);

    function caregarVAPM() {
        const vascp = document.getElementById('VASCP')?.value;
        const grupoVAPM = document.getElementById('GrupoVAPM');
        const vapmSelect = document.getElementById('VAPM');

        grupoVAPM.style.display = 'block';
        vapmSelect.disabled = false;
        vapmSelect.style.display = 'block';
        vapmSelect.value = '';
    }

    function carregarHYPL() {
        const hymo = document.getElementById('HYMO')?.value;
        const hyva = document.getElementById('HYVA')?.value;
        const hycp = document.getElementById('HYCP')?.value;
        const hybu = document.getElementById('HYBU')?.value;
        const hycm = document.getElementById('HYCM')?.value;
        const hyplSelect = document.getElementById('HYPL');
        const grupohypl = document.getElementById('GrupoHYPL');

        const permitirS = (
            hymo === "N" &&
            hyva === "N" &&
            hycp === "B14" &&
            hybu === "N" &&
            ["63", "71", "80", "90", "100-112"].includes(hycm) &&
            !hycm.includes("EE")
        );

        const valorAtual = hyplSelect.value;

        hyplSelect.innerHTML = '';
        hyplSelect.disabled = false;

        if (permitirS) hyplSelect.appendChild(new Option("SIM", "S"));
        hyplSelect.appendChild(new Option("NÃO", "N"));

        if (Array.from(hyplSelect.options).some(opt => opt.value === valorAtual)) {
            hyplSelect.value = valorAtual;
        } else {
            hyplSelect.value = "N";
        }

        grupohypl.style.display = 'block';
        grupohypl.dispatchEvent(new Event('change'));

        carregarPLDE();
    }

    document.getElementById('HYMO')?.addEventListener('change', carregarHYPL);
    document.getElementById('HYVA')?.addEventListener('change', carregarHYPL);
    document.getElementById('HYCP')?.addEventListener('change', carregarHYPL);
    document.getElementById('HYBU')?.addEventListener('change', carregarHYPL);
    document.getElementById('HYCM')?.addEventListener('change', carregarHYPL);
    document.getElementById('HYPL')?.addEventListener('change', carregarPLDE);

    async function carregarPLDE() {
        const hypl = document.getElementById('HYPL')?.value;
        const hyln = document.getElementById('HYLN')?.value;
        const hybr = document.getElementById('HYBR')?.value;
        const hycm = document.getElementById('HYCM')?.value;
        const grupoPLDE = document.getElementById('GrupoPLDE');
        const pldeSelect = document.getElementById('PLDE');
        const subgrupohypl = document.querySelector('#GrupoHYPL .subgrupo');

        if (hypl === "S") {
            grupoPLDE.style.display = 'block';
            if (subgrupohypl) subgrupohypl.style.display = 'block';

            const response = await fetch(`/Paginas/Seletores/Configuradores/HY/PLDE.php?HYLN=${encodeURIComponent(hyln)}&HYBR=${encodeURIComponent(hybr)}&HYCM=${encodeURIComponent(hycm)}`);
            const optionsHTML = await response.text();
            pldeSelect.innerHTML = optionsHTML;
            pldeSelect.style.display = 'block';
            pldeSelect.disabled = false;
            pldeSelect.value = '';
            pldeSelect.dispatchEvent(new Event('change'));
        } else {
            grupoPLDE.style.display = 'none';
            if (subgrupohypl) subgrupohypl.style.display = 'none';
            subgrupohypl.style.display = 'none';
        }

        carregarPLBU();
    }

    document.getElementById('PLDE')?.addEventListener('change', carregarPLBU);

    async function carregarPLBU() {
        const plde = document.getElementById('PLDE')?.value;
        const hyln = document.getElementById('HYLN')?.value;
        const hybr = document.getElementById('HYBR')?.value;
        const hycm = document.getElementById('HYCM')?.value;
        const grupoPLBU = document.getElementById('GrupoPLBU');
        const plbuSelect = document.getElementById('PLBU');
        const subgrupoPLBU = document.querySelector('#GrupoPLDE .subgrupo');

        if (plde) {
            grupoPLBU.style.display = 'block';
            if (subgrupoPLBU) subgrupoPLBU.style.display = 'block';

            const response = await fetch(`/Paginas/Seletores/Configuradores/HY/PLBU.php?HYLN=${encodeURIComponent(hyln)}&HYBR=${encodeURIComponent(hybr)}&HYCM=${encodeURIComponent(hycm)}&PLDE=${encodeURIComponent(plde)}`);
            const optionsHTML = await response.text();
            plbuSelect.innerHTML = optionsHTML;
            plbuSelect.disabled = false;
            plbuSelect.style.display = 'block';
            plbuSelect.value = '';
        } else {
            grupoPLBU.style.display = 'none';
            if (subgrupoPLBU) subgrupoPLBU.style.display = 'none';
        }

        carregarPLGU();
    }

    document.getElementById('PLBU')?.addEventListener('change', carregarPLGU);

    async function carregarPLGU() {
        const hypl = document.getElementById('HYPL')?.value;
        const hycm = document.getElementById('HYCM')?.value;
        const plde = document.getElementById('PLDE')?.value;
        const plbu = document.getElementById('PLBU')?.value;
        const grupoPLGU = document.getElementById('GrupoPLGU');
        const plguSelect = document.getElementById('PLGU');

        grupoPLGU.style.display = 'block';

        const response = await fetch(`/Paginas/Seletores/Configuradores/HY/PLGU.php?HYCM=${encodeURIComponent(hycm)}&PLDE=${encodeURIComponent(plde)}&PLBU=${encodeURIComponent(plbu)}`);
        const optionsHTML = await response.text();
        plguSelect.innerHTML = optionsHTML;
        plguSelect.disabled = false;
        plguSelect.style.display = 'block';
        plguSelect.dispatchEvent(new Event('change'));
        plguSelect.value = '';

        carregarPLFU()
    }

    document.getElementById('PLGU')?.addEventListener('change', carregarPLFU);

    async function carregarPLFU() {
        const hycm = document.getElementById('HYCM')?.value;
        const plde = document.getElementById('PLDE')?.value;
        const plbu = document.getElementById('PLBU')?.value;
        const plgu = document.getElementById('PLGU')?.value;
        const grupoPLFU = document.getElementById('GrupoPLFU');
        const plfuSelect = document.getElementById('PLFU');

        grupoPLFU.style.display = 'block';

        const response = await fetch(`/Paginas/Seletores/Configuradores/HY/PLFU.php?HYCM=${encodeURIComponent(hycm)}&PLDE=${encodeURIComponent(plde)}&PLBU=${encodeURIComponent(plbu)}&PLGU=${encodeURIComponent(plgu)}`);
        const optionsHTML = await response.text();
        plfuSelect.innerHTML = optionsHTML;
        plfuSelect.disabled = false;
        plfuSelect.style.display = 'block';
        plfuSelect.value = '';
        plfuSelect.dispatchEvent(new Event('change'));
    }

</script>

<script>

    function exibirBotaoCompartilhar() {
        const wrapper = document.getElementById("compartilhar-wrapper");
        if (wrapper) wrapper.style.display = "block";
        if (typeof exibirBotaoRefazerConfiguracao === "function") exibirBotaoRefazerConfiguracao();
    }

    function exibirBotaoSolicitarDesenho() {
        document.getElementById("solicitar-wrapper").style.display = "inline-flex";
    }

    function exibirBotaoSolicitarCotacao() {
        const wrapper = document.getElementById("cotacao-wrapper");
        if (wrapper) wrapper.style.display = "block";
    }

    async function gerarCodigoProduto() {
        const FORMACONSTRUTIVA = v("HYCM").includes("EE") ? "" : v("HYCP");
        const FORMACONSTRUTIVAREDUTOR = (v("HYMO") === "N" && v("HYVA") === "N" && v("HYPL") === "N")
            ? `${v("HYCM")}${FORMACONSTRUTIVA}.`
            : "";

        const POSICAOACESSORIOFIXACAO = (["1.R", "1.X"].includes(v("HYLN")) && !["N", "PE"].includes(v("HYAF")))
            ? `.${v("HYAFP")}` : "";

        const POSICAOBRACOTORQUE = (
            (v("HYAF") === "BT" && v("HYLN") === "1.X" && ["22S", "32S", "33S", "42A", "43A", "52A", "53A", "62A", "63A", "93C", "94C"].includes(v("HYBR")))
            || (v("HYAF") === "BT" && v("HYLN") === "1.R")
        ) ? `.${v("HYBT")}` : "";

        const PESREDUTOR = v("HYAF") === "PE" ? `.${v("HYPE")}` : "";

        const POSICAOACESSORIOSAIDA = (!["N", "ED"].includes(v("HYAS")) && ["1.R", "1.X"].includes(v("HYLN")))
            ? `.${v("HYASP")}` : "";

        const POSICAOMONTAGEM = ["1.M", "1.R"].includes(v("HYLN")) ? "" : `.${v("HYPM")}`;

        const TEMOPCIONAISREDUTOR = (v("HYOPC") === "NÃO" || vazio(v("HYOPC"))) ? "" : `.${v("HYOPC")}`;
        const VARIOSOPCIONAISREDUTOR = contem(TEMOPCIONAISREDUTOR, ",")
            ? substituir(TEMOPCIONAISREDUTOR, ", ", ".")
            : TEMOPCIONAISREDUTOR;

        const PESMOTOR = (v("HYMO") === "S" && v("MOLN") !== "3.W" && ["B3", "B34", "B35"].includes(v("MOCP")))
            ? v("MOCPP") : "";

        const CARCACA100112 = (v("HYMO") === "S" && v("HYCM") === "100-112")
            ? await get("CARCACA100112.php", {
                MOLN: v("MOLN"),
                MOTP: v("MOTP"),
                MOTT: v("MOTT"),
                MOFQ: v("MOFQ"),
                MOPT: v("MOPT"),
                MOPL: v("MOPL")
            })
            : v("HYCM");

        const CARCACAINICIO = (v("HYMO") === "S")
            ? await get("CARCACAINICIO.php", {
                MOLN: v("MOLN"),
                MOTP: v("MOTP"),
                MOTT: v("MOTT"),
                MOFQ: v("MOFQ"),
                MOPT: v("MOPT"),
                MOPL: v("MOPL"),
                MOCM: CARCACA100112
            })
            : "";

        const CARCACAFIM = (v("HYMO") === "S")
            ? await get("CARCACAFIM.php", {
                MOLN: v("MOLN"),
                MOTP: v("MOTP"),
                MOTT: v("MOTT"),
                MOFQ: v("MOFQ"),
                MOPT: v("MOPT"),
                MOPL: v("MOPL"),
                MOCM: CARCACA100112
            })
            : "";

        const FORMACONSTRUTIVAMOTORREDUTOR = v("HYMO") === "S"
            ? `${CARCACAINICIO}${CARCACA100112}${CARCACAFIM}${v("MOCP")}${PESMOTOR}.`
            : "";

        const TEMOPCIONAIS = (v("HYMO") === "S" && v("MOOPC") !== "NÃO" && !vazio(v("MOOPC"))) ? `.${v("MOOPC")}` : "";
        const VARIOSOPCIONAIS = contem(TEMOPCIONAIS, ",") ? substituir(TEMOPCIONAIS, ", ", ".") : TEMOPCIONAIS;
        const OPCIONAISPADRAO = contem(VARIOSOPCIONAIS, "CR") ? `${VARIOSOPCIONAIS}${v("MOCR")}` : VARIOSOPCIONAIS;
        const CAIXADELIGACAO = (v("HYMO") === "S" && v("MOPC") !== "CX270") ? `.${v("MOPC")}` : "";

        const PRENSACABO = (v("HYMO") === "S" && !(
            ["3.APM", "3.SPM"].includes(v("MOLN")) ||
            (v("MOLN") === "3.I" && v("MOPP") === "PC1") ||
            (v("MOLN") === "2.I" && v("MOTP") === "T" && v("MOPP") === "PC1") ||
            (v("MOLN") === "2.I" && v("MOTP") === "M" && v("MOPP") === "PC2") ||
            (v("MOLN") === "3.W" && v("MOPP") === "PC3") ||
            vazio(v("MOPP"))
        )) ? `.${v("MOPP")}` : "";

        const CODIGOMOTOR = v("HYMO") === "S"
            ? `.${v("MOLN")}.${v("MOTP")}.${v("MOTT")}.${v("MOPT")}.${v("MOPL")}.${FORMACONSTRUTIVAMOTORREDUTOR}${v("MOFQ")}${OPCIONAISPADRAO}${CAIXADELIGACAO}${PRENSACABO}`
            : "";

        const FORMACONSTRUTIVAVARIADOR = (v("HYVA") === "S" && v("HYMO") === "N") ? `.${v("HYCM")}${v("VAECP")}` : "";
        const FORMACONSTRUTIVAVARIADORETIQUETA = (v("HYVA") === "S") ? `.${v("HYCM")}${v("VAECP")}` : "";
        const CODIGOVARIADOR = (v("HYVA") === "S")
            ? `.${v("VALN")}.${v("VAPT")}${FORMACONSTRUTIVAVARIADOR}.${v("VASCP")}.${v("VAPM")}`
            : "";

        const FORMACONSTRUTIVAADAPTACAO = (v("HYMO") === "N" && v("HYVA") === "N" && v("HYPL") === "S") ? `${v("HYCM")}BSV.` : "";
        const CODIGOADAPTACAO = v("HYPL") === "S"
            ? `${v("PLDE")}.${v("PLBU")}.${v("PLGU")}.${v("PLFU")}.`
            : "";

        const LINHAPRODUTO = seAlgum(
            v("HYMO") === "N" && v("HYVA") === "N" && v("HYPL") === "N", v("HYLN"),
            v("HYMO") === "N" && v("HYVA") === "N" && v("HYPL") === "S", v("HYLN"),
            v("HYMO") === "N" && v("HYVA") === "S" && v("HYPL") === "N", v("HYLN"),
            v("HYMO") === "S" && v("HYVA") === "N" && v("HYPL") === "N", substituir(v("HYLN"), "1.", "M."),
            v("HYMO") === "S" && v("HYVA") === "S" && v("HYPL") === "N", substituir(v("HYLN"), "1.", "MV.")
        );

        const COMPOSICAOCODIGO = [
            LINHAPRODUTO,
            v("HYBR"),
            v("HYRD"),
            FORMACONSTRUTIVAREDUTOR,
            FORMACONSTRUTIVAADAPTACAO,
            CODIGOADAPTACAO,
            v("HYCM").includes("EE") ? "" : (vazio(v("HYBU")) ? "N." : `${v("HYBU")}.`),
            v("HYAF"),
            POSICAOACESSORIOFIXACAO,
            POSICAOBRACOTORQUE,
            v("HYAS"),
            POSICAOACESSORIOSAIDA,
            PESREDUTOR,
            POSICAOMONTAGEM,
            VARIOSOPCIONAISREDUTOR,
            CODIGOVARIADOR,
            CODIGOMOTOR
        ]
            .map(s => s.replace(/^\.|\.$/g, ""))
            .map(s => s.replace(/,\s*/g, ".").replace(/\s+/g, ""))
            .map(s => s.replace(/\.{2,}/g, "."))
            .filter(Boolean)
            .join(".");

        document.getElementById("refProduto").textContent = COMPOSICAOCODIGO;
        mostrarDetalhesProduto({}, COMPOSICAOCODIGO);

        fetch("/Paginas/Seletores/Produto/CodigoDescricaoObservacaoProduto.php", {
            method: "POST",
            headers: { "Content-Type": "application/x-www-form-urlencoded" },
            body: `codigo=${encodeURIComponent(COMPOSICAOCODIGO)}`
        })
            .then(resp => resp.text())
            .then(text => {
                let dados;
                try { dados = JSON.parse(text); } catch { throw new Error(text); }
                return dados;
            })
            .then(dados => {
                mostrarDetalhesProduto(dados || {}, COMPOSICAOCODIGO);
                if (typeof mostrarDetalhesEstoque === 'function') {
                    mostrarDetalhesEstoque(dados?.CD_PRODUTO || "");
                }
            })
            .catch(err => {
                console.error('Erro ao obter dados do produto', err);
                if (typeof exibirAlerta === 'function') {
                    exibirAlerta('⚠️ Erro ao obter dados do produto.');
                }
                mostrarDetalhesProduto({}, COMPOSICAOCODIGO);
                if (typeof mostrarDetalhesEstoque === 'function') {
                    mostrarDetalhesEstoque('');
                }
            });


        if (window.ultimoHistoricoProduto !== COMPOSICAOCODIGO) {
            const linkAtual = gerarLinkAtual();
            fetch("/Paginas/AreaCliente/Sessao/Produtos/RegistrarProduto.php", {
                method: "POST",
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                body: `produto=${encodeURIComponent(COMPOSICAOCODIGO)}&link=${encodeURIComponent(linkAtual)}`
            });
            window.ultimoHistoricoProduto = COMPOSICAOCODIGO;
        }

        exibirBotaoCompartilhar();
        exibirBotaoSolicitarDesenho();
        exibirBotaoSolicitarCotacao();
    }
</script>

<script>
    document.addEventListener('click', e => {
        const img = e.target.closest('.popover img');
        if (!img) return;
        e.preventDefault();
        const container = img.closest('.popover-body');
        if (!container) return;
        const imgs = Array.from(container.querySelectorAll('img')).filter(i => i.naturalWidth);
        const index = imgs.indexOf(img);
        const items = imgs.map(i => ({
            src: i.src,
            width: i.naturalWidth || 800,
            height: i.naturalHeight || 600
        }));
        const lb = new PhotoSwipeLightbox({
            dataSource: items,
            pswpModule: PhotoSwipe,
            initialZoomLevel: 1,
            secondaryZoomLevel: 2,
            wheelToZoom: true,
            imageClickAction: 'zoom'
        });
        lb.on('close', () => lb.destroy());
        lb.init();
        lb.loadAndOpen(index);
    });
</script>

</body>

</html>