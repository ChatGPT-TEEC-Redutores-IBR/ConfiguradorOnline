window.dataLayer=window.dataLayer||[],window.gtag=window.gtag||function(){window.dataLayer.push(arguments)};var gtagLoaded=!1,pageStartTime=Date.now(),scrollDepthTracked=!1;function hasAnalyticsConsent(){try{if(window.LGPDCOOKIES&&"function"==typeof LGPDCOOKIES.getValueCookie){var e=LGPDCOOKIES.getValueCookie("lgpd-cookies-consent");if(e)return!!JSON.parse(decodeURIComponent(e)).Performance}}catch(e){}return!1}function loadGtag(){if(!gtagLoaded){gtagLoaded=!0;var e=document.createElement("script");e.src="https://www.googletagmanager.com/gtag/js?id=G-46RENX5RDK",e.async=!0,e.onload=function(){gtag("js",new Date),gtag("config","G-46RENX5RDK",{anonymize_ip:!0,transport_type:"beacon",page_path:location.pathname}),gtag("event","page_loaded",{event_category:"general",event_label:"layout"})},document.head.appendChild(e)}}function trackPageView(e){gtagLoaded&&gtag("config","G-46RENX5RDK",{page_path:e||location.pathname})}function getCurrentLinha(){for(var e=new URLSearchParams(window.location.search),t=0,a=Array.from(e.keys());t<a.length;t++){var n=a[t];if(n.toUpperCase().endsWith("LN"))return e.get(n)||""}var o=document.querySelector("[data-linha]");if(o&&o.dataset.linha)return o.dataset.linha;var r=document.querySelector('input[id$="LN"], select[id$="LN"]');return r&&r.value?r.value:""}function sendLoginEventIfNeeded(){try{var e=new URLSearchParams(window.location.search);if("sucesso"===e.get("login")){gtag("event","login",{event_category:"Conta"}),e.delete("login");var t=e.toString(),a=window.location.pathname+(t?"?"+t:"")+window.location.hash;history.replaceState({},"",a)}}catch(e){}}function setupEngagementTracking(){window.addEventListener("pagehide",function(){if(gtagLoaded){var e=Math.round((Date.now()-pageStartTime)/1e3);e>0&&gtag("event","tempo_pagina",{event_category:"Engajamento",value:e})}}),window.addEventListener("scroll",function(){!scrollDepthTracked&&gtagLoaded&&((window.scrollY||document.documentElement.scrollTop)/(document.documentElement.scrollHeight-document.documentElement.clientHeight)>=.75&&(scrollDepthTracked=!0,gtag("event","scroll_75",{event_category:"Engajamento"})))})}function setupEventTracking(){var e=function(e){return document.getElementById(e)},t=function(e,t,a){e&&!e.dataset.gtagBound&&(e.dataset.gtagBound="1",e.addEventListener(t,a))};t(e("aplicarFiltros"),"click",function(){gtag("event","aplicar_filtros",{event_category:"Filtro"})}),document.querySelectorAll(".botao-home").forEach(function(e){t(e,"click",function(){var t=e.dataset.linha||""||e.title||e.querySelector(".botao-titulo")?.textContent||"";gtag("event","acesso_linha_produtos",{event_category:"Navegacao",event_label:t.trim()})})}),document.querySelectorAll(".gerar-produto").forEach(function(e){t(e,"click",function(){var e=getCurrentLinha();gtag("event","gerar_produto",{event_category:"Produto",event_label:e})})}),t(e("toggleProduto"),"click",function(){gtag("event","info_produto",{event_category:"Produto",event_label:getCurrentLinha()})}),t(e("toggleEstoque"),"click",function(){gtag("event","info_estoque",{event_category:"Produto",event_label:getCurrentLinha()})}),t(e("botaoEnviarDesenho"),"click",function(){gtag("event","solicitar_desenho",{event_category:"Produto",event_label:getCurrentLinha()})}),t(e("botaoEnviarCotacao"),"click",function(){gtag("event","solicitar_cotacao",{event_category:"Produto",event_label:getCurrentLinha()})}),t(e("btnCompartilhar"),"click",function(){gtag("event","compartilhar",{event_category:"Social",event_label:getCurrentLinha()})}),document.querySelectorAll('a[href="/AreaCliente"]').forEach(function(e){t(e,"click",function(){gtag("event","acesso_area_cliente",{event_category:"Navegacao",event_label:getCurrentLinha()})})}),t(e("cadastro"),"submit",function(){gtag("event","cadastro",{event_category:"Conta"})}),t(document.querySelector("#modal-excluir button.botao-primario"),"click",function(){gtag("event","excluir_conta",{event_category:"Conta"})}),document.body.addEventListener("click",function(e){var t=e.target.closest("a[href]");t&&t.href.includes("www.redutoresibr.com.br")&&gtag("event","redirecionar_ibr",{event_category:"Navegacao",event_label:t.href})}),t(e("formBusca"),"submit",function(){gtag("event","pesquisar_produto",{event_category:"Busca"})}),document.querySelectorAll(".theme-toggle, .theme-toggle-mobile").forEach(function(e){t(e,"click",function(){setTimeout(function(){var e=document.body.classList.contains("dark-mode")?"escuro":"claro";gtag("event","alternar_modo_cor",{event_category:"Personalizacao",event_label:e})},0)})})}window.addEventListener("load",function(){hasAnalyticsConsent()&&(loadGtag(),trackPageView()),setupEventTracking(),sendLoginEventIfNeeded()}),document.addEventListener("DOMContentLoaded",setupEventTracking),navigator.serviceWorker&&navigator.serviceWorker.addEventListener("message",function(e){e.data&&"offline-request"===e.data.type&&gtag("event","offline_request",{event_category:"ServiceWorker",event_label:e.data.url||""})});